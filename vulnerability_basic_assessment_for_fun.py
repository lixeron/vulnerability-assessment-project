import nmap

# DO NOT USE IN A PLACE YOU DON'T HAVE PERMISSION TO USE IT. Use only if in a controlled environment
# It is illegal to scan a network or system without permission
# I am not liable for any actions you do. This is merely testing my skills

def vulnerability_scan(target):
    # Initialize the Nmap Scanner
    nm = nmap.PortScanner()

    # Scanning the target for open ports
    print(f"Scanning {target} for open ports...")
    nm.scan(target, '1-1024')

    # Displaying open ports
    for host in nm.all_hosts():
        print(f"Host : {host} ({nm[host].hostname()})")
        print("State : %s" % nm[host].state())
        for proto in nm[host].all_protocols():
            print('----------')
            print('Protocol : %s' % proto)

            lport = nm[host][proto].keys()
            for port in lport:
                print('port : %s\tstate : %s' % (port, nm[host][proto][port]['state']))

    # Using Nmap's Vulners script for vulnerability scanning
    print(f"Scanning {target} for vulnerabilities...")
    nm.scan(target, '1-1024', arguments='-sV --script=vulners')

    # Displaying vulnerabilities
    for host in nm.all_hosts():
        for proto in nm[host].all_protocols():
            lport = nm[host][proto].keys()
            for port in lport:
                for script, output in nm[host][proto][port]['script'].items():
                    print(f"Port: {port}, Script: {script}, Output: {output}")

if __name__ == "__main__":
    target = input("Enter the target IP or range: ")
    vulnerability_scan(target)
